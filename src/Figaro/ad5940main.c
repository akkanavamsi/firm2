
#include "ad5940main.h"

#include "definitions.h" 
#include "BodyImpedance.h"
#include "mpfit.h"

#define APPBUFF_SIZE 512

AD5940_DATA ad5940Data;
uint32_t AppBuff[APPBUFF_SIZE];
uint32_t IntCount;
uint32_t count;
uint32_t temp;

double curveData[6];

double xOffset[] = {-414.8721043, -3029.195833, 34768.58352, 1.45540895, 25.00049705, 48.0512121};
double scaleX[] = {312.078866, 2334.992901,	21331.29304, 0.038817469, 11.19700352, 26.9476651};
double xTrained[360][6] = { 
							-2.00439869681084, -3.40139574271618, -1.33591874208715, 2.68030254614104, -0.445382913740193, 0.0882796490152668,
							-1.77310501061074, -2.41465095842353, -1.26319628263183, 1.74080893852264, -0.445924999287515, 0.0727754825666232,
							-1.47923887902452, -1.66864584282554, -1.18110096533038, 1.29217372258813, -0.448319466567872, 0.0670382962219927,
							-1.30031490152795, -1.2794051371918, -1.11933897147102, 0.978362086519052, -0.44684932317775, 0.0407235906514975,
							-1.16509667414444, -0.955109389450434, -1.05065180062951, 0.490607670805677, -0.444465364693771, 0.0686846484624246,
							-1.11084187469732, -0.772948300076288, -1.0017899357019, 0.01829480332274, -0.445057533486056, 0.0432245190264583,
							-1.06317656351942, -0.570485392172947, -0.936564512522124, -0.676748638939304, -0.446924734714301, 0.0987978476783327,
							-1.03915307313417, -0.472818290307569, -0.899793950279987, -1.05688044749988, -0.446708386902471, 0.0754357810982626,
							-0.991333677112815, -0.365096371611818, -0.854351844989249, -1.4317175733661, -0.446208260386355, 0.104683940103485,
							-0.925306946912145, -0.26711379479181, -0.807811801523845, -1.69685726922487, -0.448061616008527, 0.0608696878946151,
							-0.863279466114939, -0.202073303912071, -0.773731225330879, -1.8113813575294, -0.445482200769825, 0.0474668554119898,
							-0.809702169857816, -0.15839363690445, -0.748616695373457, -1.84361650714814, -0.442708754560554, 0.0620660763633115,
							-0.401052841450338, 0.0664373851488602, -0.584414096619025, -1.54146821348029, -0.450113826758892, 0.0853828340030581,
							0.129781552469719, 0.261907152666991, -0.360990110824771, -0.641000040175519, -0.444519687573911, 0.0618201691563574,
							0.449220450477216, 0.386361566417307, -0.161766338312843, -0.118041386215739, -0.448339993087279, 0.0215715891441564,
							0.616602175231749, 0.469580367062599, 0.00077305419009648, 0.0727841259410238, -0.446203066580717, 0.0558669718787787,
							0.7257455436633, 0.538315868510853, 0.15640360614789, 0.140072417479275, -0.447954101335673, 0.0664626478858692,
							0.798585459564832, 0.591393516540275, 0.294305364316472, 0.175358336704449, -0.446785648381283, 0.0620774209395079,
							0.849583171448818, 0.634817194687667, 0.421186424849494, 0.174811485565758, -0.444883516297707, 0.0390048505591904,
							0.884916149884673, 0.669009159847005, 0.531916795639532, 0.168503699999189, -0.450104364118299, 0.0593707004809511,
							0.918813305779472, 0.706493182211926, 0.665786943632175, 0.149765182164112, -0.446365527594255, 0.0621968801474747,
							0.943411286875318, 0.733134215239674, 0.771799575092784, 0.155401682572572, -0.449814086028719, 0.0826621444559574,
							0.961696993750873, 0.755389133991339, 0.867183682164423, 0.15094134359289, -0.446404321347373, 0.0723879327670649,
							0.976229785982613, 0.773566704447002, 0.951000142101783, 0.16239142779158, -0.447369187518335, 0.0872262455229974,
							0.991030151895951, 0.792948577661878, 1.04664376054651, 0.172051179255567, -0.447007024764365, 0.0953150472284844,
							1.00057094755128, 0.804617473651583, 1.1074485377688, 0.19467885382138, -0.444523120016345, 0.0597744351755013,
							1.01334610677087, 0.820391527690377, 1.19530682794761, 0.223830497401428, -0.448114978145011, 0.0650152329908145,
							1.0200341974459, 0.829571692959031, 1.2490229597162, 0.238526934696166, -0.445108703288684, 0.0644449436674119,
							1.0292759677056, 0.841595425656806, 1.32194197806696, 0.272161754102707, -0.447794888793919, 0.0728485198476766,
							1.02945137961146, 0.841622466591019, 1.32199607715185, 0.271818285943963, -0.448882426379424, 0.0496416505800195,
							-2.0736037139679, -3.96609521355747, -1.38393890939713, 3.18390288898966, -0.446654137271392, -1.41193544537712,
							-2.04866361098126, -3.77295757476866, -1.35781006330716, 3.17763731572708, -0.446268882608092, -1.4117139596563,
							-1.91572176790817, -2.93810791702194, -1.30520846107007, 2.18056667677406, -0.446221155469382, -1.4059098492764,
							-1.77046555926801, -2.40070377687177, -1.26181495080896, 1.71308774234097, -0.446553686787629, -1.40891916054007,
							-1.64819837346191, -2.06531545844978, -1.22905674159278, 1.51406468311035, -0.446799758021398, -1.41397421427798,
							-1.53148508889785, -1.77969482511948, -1.19562547068536, 1.33967392431783, -0.446522162823253, -1.41252929408952,
							-1.42568476214199, -1.54944240460691, -1.16408060958398, 1.20493479779676, -0.446694916054689, -1.40999173613938,
							-1.34657497674218, -1.38230412516666, -1.13766084972972, 1.08371249285775, -0.446175174362096, -1.41193719363656,
							-1.28022493543067, -1.23193307154827, -1.11041127021934, 0.915501086458362, -0.446613411293294, -1.41077916176855,
							-1.23080098031747, -1.12031894504727, -1.08818216740119, 0.775682655136225, -0.446494979238865, -1.41520073814813,
							-1.18311431656414, -1.00032000941584, -1.06143912021375, 0.570703811249823, -0.446241084079715, -1.40815789368596,
							-1.15693651451386, -0.926330648930321, -1.04350264838877, 0.413347217194133, -0.44674290094718, -1.41451714665049,
							-1.05910734874547, -0.551329928550392, -0.929674836752293, -0.757134714440098, -0.446113916755189, -1.41423843291055,
							-0.787603729061793, -0.143484809867376, -0.739842074283922, -1.84022224697749, -0.446467327205933, -1.40970135342312,
							-0.407046749492541, 0.0622455368247406, -0.588451883126469, -1.53464214292117, -0.446377409126649, -1.4095853748091,
							-0.0799745344908334, 0.1858002565534, -0.459863120571825, -0.995431560775046, -0.446677634599905, -1.41426484046932,
							0.175212823611462, 0.27671427440515, -0.339845462466793, -0.5427315495278, -0.444871817033721, -1.41613855103197,
							0.303454010630577, 0.324333354266181, -0.267136477173916, -0.324744297255821, -0.445675282921373, -1.46325860551161,
							0.430323937964007, 0.376526882581047, -0.179712803663467, -0.125454368868783, -0.44724240176644, -1.47403405595783,
							0.540323701396681, 0.428468418803462, -0.0834092636680894, 0.00908069491240004, -0.446764787986835, -1.47147993696493,
							0.6515523096072, 0.488149349604796, 0.0402750210616443, 0.118983325612463, -0.446562691201162, -1.43276510070548,
							0.709975929428969, 0.526033720929383, 0.126486575784153, 0.155957811349342, -0.446559100337773, -1.43124441262874,
							0.758768896337242, 0.559533998771817, 0.209551654041945, 0.174905051260572, -0.446382309939613, -1.42797089193404,
							0.795717451502452, 0.587986809916018, 0.284680255484977, 0.180844735666463, -0.446647756164171, -1.4265050312067,
							0.826433837340897, 0.614517709269271, 0.359713921683314, 0.180200895144227, -0.446450171565175, -1.41965798955066,
							0.8533512193647, 0.63743573331046, 0.429386707616162, 0.179520351954942, -0.446345074323017, -1.41253539742617,
							0.873220506711933, 0.657381989325399, 0.492679048266364, 0.172002900568372, -0.446935454497492, -1.40417018350917,
							0.89061201600863, 0.674153281431542, 0.549556254934839, 0.170287104520573, -0.446468143156377, -1.3906496312305,
							0.905087763189051, 0.690292761532609, 0.606135308482358, 0.158863564736392, -0.446572354848211, -1.35454047599055,
							0.925108295380182, 0.711163396202499, 0.683949320490466, 0.163691182751705, -0.447419422128794, -1.23711094249103,
							-1.73890050089364, -2.31347215746432, -1.25399574396337, 1.66950547115381, -0.448798763352208, 1.28755127378253,
							-1.30721184744611, -1.2928185569259, -1.12189986724479, 0.989557878368915, -0.449792355913191, 1.4339419031191,
							-1.1820064438732, -1.00112479757487, -1.06194145962608, 0.583807131678651, -0.442502596761599, 0.806468953401031,
							-1.11803454538389, -0.803120098690569, -1.01065025845427, 0.10886574747928, -0.448810515423179, 1.07905743422236,
							-1.02381229300799, -0.433164926674464, -0.88391653490643, -1.19830102629345, -0.447126797431038, 1.4564696825974,
							-0.960422370577351, -0.313407482535052, -0.830858197450362, -1.58120028346981, -0.442746271246992, 0.899125517226966,
							-0.959325089004602, -0.313382090030836, -0.830766169779539, -1.57810319454297, -0.448736846511784, 1.14478538018724,
							-0.711017798161228, -0.0880065242975106, -0.704765031368445, -1.85316187407536, -0.446684099175886, 1.44886401771023,
							-0.644039110683752, -0.0494832548874941, -0.678314364300348, -1.81173914880095, -0.442160287664874, 0.873758685392859,
							-0.683324987345165, -0.0719861102292816, -0.693687254739985, -1.84070374195361, -0.447604228941342, 1.0966991391303,
							-0.390629298434955, 0.0714581150736606, -0.580335320235151, -1.52804468708735, -0.446546716287908, 1.47807726107151,
							-0.253505032800181, 0.125285877933514, -0.527934333783662, -1.31132896125098, -0.445732162673087, 1.22590261600206,
							-0.161813332543803, 0.158777255174212, -0.491278992371904, -1.15876082915398, -0.446161466735787, 0.740493368956756,
							0.449938551477561, 0.387603331111164, -0.159836962169023, -0.127763601294893, -0.447692273230904, 1.33935232418715,
							0.722475556275525, 0.535850178841901, 0.149920659845636, 0.142091944753533, -0.447800808266928, 1.44608924536656,
							0.798894253394679, 0.592403927299022, 0.296807387787207, 0.166558659719463, -0.443184065282018, 0.847436981122132,
							0.830773619120019, 0.618968837523551, 0.373801596427132, 0.156667097174388, -0.44873391488192, 1.15297356230507,
							0.921049309714022, 0.708514508793779, 0.674362692444946, 0.138897204671086, -0.445905312808033, 1.46949668175752,
							0.953826404139945, 0.745843619608192, 0.824920137318195, 0.143138314261364, -0.443902758149947, 1.10466290143898,
							0.935696669822353, 0.725972488652909, 0.742516976481732, 0.129592846003394, -0.446943113188478, 0.852827738548946,
							0.989917414840244, 0.792049451066491, 1.04222890855592, 0.158480496958812, -0.448122531222928, 1.4533949825361,
							1.01959312451459, 0.8294711474561, 1.24754498544758, 0.222861129052723, -0.448915575258, 1.27416366038729,
							0.998817751218651, 0.802218940742012, 1.09531493187774, 0.175713867316372, -0.444712922327002, 0.734699744594803,
							1.0343087806492, 0.848928521806027, 1.36931168695716, 0.265717989826475, -0.448046440011678, 1.41414657116059,
							1.06260658283092, 0.884728431605123, 1.62439602354618, 0.436468432476125, -0.444812622299257, 1.30447007126809,
							1.04166535907205, 0.857594221541821, 1.4275792666894, 0.305261379708969, -0.446793039631975, 0.839374348100921,
							1.07811495819309, 0.904851486549512, 1.79151412578717, 0.554887338574002, -0.446876227397217, 1.46750763243651,
							1.08887447787254, 0.918008478626538, 1.90724074730367, 0.662883269129361, -0.444301459158948, 0.984998682765968,
							1.08106811885323, 0.908613009790403, 1.8233421771403, 0.579881456268201, -0.450198467563777, 1.2470550241476,
							1.10680089546107, 0.939161018535543, 2.12242308866755, 0.886626121833901, -0.4449672423525, 1.16325112543572,
							-1.6351827134164, -2.03152755409556, -1.22555044627024, 1.4942881626399, 0.445200304088686, 1.40043330016957,
							-1.30261516683827, -1.28287051063462, -1.1201489693434, 0.976939009213937, 0.441850794511213, 1.34776059902681,
							-1.15583703043154, -0.922103391909982, -1.04260447874742, 0.403186248689241, 0.439516851546934, 1.05511722176809,
							-1.08414313604521, -0.659062686141776, -0.967137488561692, -0.357120307426114, 0.447839550014131, 0.704206607160496,
							-0.993018946045515, -0.368510622803732, -0.856619168675103, -1.41075886198833, 0.451897546945208, 0.798924323296047,
							-0.820002822011174, -0.166136932625789, -0.753703314444989, -1.84304615287246, 0.453521514879312, 1.06411466258626,
							-0.656231245245737, -0.0570869104102437, -0.683822480813243, -1.81584965563166, 0.451750221045251, 1.34296681599898,
							-0.537312543196037, 0.00553585055916245, -0.63685628939809, -1.71292616529175, 0.446820212712642, 1.42072765123299,
							-0.496927713886597, 0.0249027217844953, -0.621113560527631, -1.66859772438827, 0.439902150499763, 1.2765386234522,
							-0.45604177430412, 0.0423599763605945, -0.606029243204492, -1.61588225376339, 0.440699804230627, 1.09665729131879,
							-0.403098896597056, 0.0638869143773242, -0.587088792018661, -1.52882939818128, 0.443436507118404, 0.79911790445975,
							-0.14407141996961, 0.163919970953469, -0.48631370974845, -1.10896902279363, 0.451179452640099, 0.761763533349364,
							0.343197888425455, 0.341186150952558, -0.240516613232542, -0.265309819293677, 0.452500672299203, 1.30678964213987,
							0.656187241776695, 0.492667464022647, 0.0494443435188, 0.116157978096703, 0.446926609855259, 1.40796825933167,
							0.769179073458605, 0.568009159354141, 0.231473755455703, 0.170014864838003, 0.440272711240735, 1.32714938235494,
							0.830858533856802, 0.618335113304323, 0.371110025639087, 0.172953350068938, 0.439150372262205, 1.12705214292425,
							0.880292371641473, 0.664317201556196, 0.51503064014903, 0.174764961848321, 0.446290878917151, 0.756070137341129,
							0.950021022893278, 0.74131618943769, 0.80416272565249, 0.164032233539172, 0.451858909391925, 0.845544707518785,
							0.988177253793866, 0.789059826545816, 1.02536634409813, 0.17494788495553, 0.454514235276596, 1.12825641484034,
							1.0113872197208, 0.818362313391774, 1.18315176520219, 0.218852604980976, 0.44771587418623, 1.36947074977904,
							1.02481972504617, 0.835899968340505, 1.285979986485, 0.261254426196168, 0.444776608577417, 1.4035879545368,
							1.02640726808352, 0.838038902293173, 1.3029136776232, 0.232248580488302, 0.440832136402151, 1.1906698052045,
							1.02677783223076, 0.839880988301044, 1.31081098513659, 0.243736119633867, 0.444653392438575, 0.750007029042007,
							1.06113039054176, 0.883056586253293, 1.60810645189047, 0.429955186096685, 0.452324157859687, 0.806966890262266,
							1.0808733807636, 0.908249268839695, 1.81793619491342, 0.586999937552693, 0.45467548343618, 1.05542157888133,
							1.09148365277184, 0.921580874104753, 1.94251412212205, 0.695283464741805, 0.453443060989505, 1.29222180209249,
							1.09662279295323, 0.927470978307965, 2.0025214339714, 0.750774733314271, 0.444804334752507, 1.39817394303518,
							1.09610009040013, 0.92710896611041, 2.00009884858982, 0.743489567046074, 0.441443240696205, 1.31622393832248,
							1.08997508492801, 0.919513203102072, 1.92436609997703, 0.676101218890298, 0.444120450745663, 1.01121837786524,
							1.09296289193278, 0.923174136273076, 1.95442655866509, 0.71930929736716, 0.463492390082511, 0.734254998705565,
							-1.68449056319515, -2.15915914361858, -1.23900120077828, 1.56708391304522, 0.445277534904839, 0.0686279878677477,
							-1.35333409740906, -1.39181838614215, -1.13916839874723, 1.07343652345732, 0.446461722586795, 0.0724997328780677,
							-1.1779233198997, -0.987144907172251, -1.05857535930439, 0.543593837302308, 0.445606952324805, 0.0700851203917352,
							-1.09529769688639, -0.709508836341839, -0.983110400306879, -0.185400501102795, 0.447000779648867, 0.0707740082414833,
							-1.05149674143799, -0.525369232203536, -0.920304891707152, -0.853825706281837, 0.446606128779721, 0.0688494916372447,
							-0.998428019655998, -0.379853901794201, -0.861389472367328, -1.37819984233994, 0.446164788170825, 0.0690605072654206,
							-0.923778635609236, -0.268389806639219, -0.809010764355022, -1.68276581507814, 0.447071104696893, 0.0772303814965417,
							-0.839627228118953, -0.184603249227665, -0.764171649393716, -1.81914652505131, 0.447105987855535, 0.0726828471341925,
							-0.741318850781916, -0.110477322726505, -0.719503688897151, -1.84653541649716, 0.445370583917318, 0.0724657189679042,
							-0.653306615651386, -0.0550281895181552, -0.682441860477717, -1.81637203961661, 0.446300428433656, 0.0666101637524428,
							-0.547923394833602, -0.00136419548058458, -0.642388825319089, -1.71490107003871, 0.446861832998765, 0.0791322358446023,
							-0.452281235721334, 0.0437654173926145, -0.605230401254055, -1.60292208301253, 0.446902816195679, 0.0762136164271617,
							-0.0569778505864524, 0.194701981577641, -0.449764554700876, -0.957112553378461, 0.446467067999066, 0.0676338963790923,
							0.402910516577184, 0.365103433136235, -0.200073688359571, -0.16832262383633, 0.447224491455892, 0.0599877318988948,
							0.623137940174077, 0.472982241190011, 0.00667786088565409, 0.092387414072082, 0.44704213079066, 0.0717768353652737,
							0.745778554999687, 0.549528506977441, 0.183995315047728, 0.173433191009376, 0.446800418674035, 0.0706897152665241,
							0.820199106694276, 0.607756818880762, 0.340486918050356, 0.186028422530479, 0.446508030754797, 0.0712841347888649,
							0.871041562279021, 0.654506622481869, 0.483302045823049, 0.177286067983519, 0.446863165092657, 0.0720157537808364,
							0.908089017591192, 0.693457276651249, 0.61732168587523, 0.158358535439293, 0.446952193973328, 0.0720733005380029,
							0.937058634321149, 0.725242128175839, 0.738900200073344, 0.155439723891047, 0.446073456232022, 0.0754497374465634,
							0.960085391009403, 0.75206439913567, 0.852214679047753, 0.162498173589397, 0.44631975572687, 0.0704557174294004,
							0.978434810136626, 0.775666877756121, 0.960013573992248, 0.166750904766053, 0.446225856695904, 0.071707066363296,
							0.994165889991201, 0.795876901830435, 1.06108927355817, 0.183904065502318, 0.446231762351814, 0.0710425946916228,
							1.0081840630468, 0.813312676484408, 1.15457637919319, 0.209409014641699, 0.446213513528387, 0.0691581733923317,
							1.01933625187534, 0.828025770672298, 1.23944812900316, 0.241060249965933, 0.446440107565461, 0.0625492018570928,
							1.02989378061176, 0.842262531177548, 1.32596468608486, 0.271246645069717, 0.446196189487209, 0.0741303720168876,
							0.216838539169592, 0.975301676198061, 1.472295905772, -1.94265473108727, 0.446015462426894, 0.0761395086273905,
							1.04389833107478, 0.859959287757092, 1.4426590886981, 0.339778405968708, 0.448456714599235, 0.0319433037183552,
							1.05272537145002, 0.872120796774348, 1.52757879174205, 0.381319789743439, 0.449121066899255, 0.122047462244535,
							1.0501093923217, 0.86790573225467, 1.49844665457109, 0.362820651018841, 0.448482250952739, 0.0880032244170325,
							-2.05084165998207, -3.7818564385428, -1.3583504477184, 3.18389437645104, 0.446299447248825, -1.4155638931833,
							-1.8880933980877, -2.81129296621006, -1.29580368116911, 2.04267652252494, 0.445823168970293, -1.41461863298874,
							-1.67304322017484, -2.12848742565018, -1.23581895313768, 1.54553250887524, 0.446576998156559, -1.39821346670923,
							-1.55106498256984, -1.82842710906752, -1.20198745956608, 1.37665614206486, 0.446355953946276, -1.42626871465396,
							-1.41046817543239, -1.51874223753578, -1.15964039830254, 1.18893491681709, 0.446330141635013, -1.42022916008168,
							-1.29432946477184, -1.26189084284998, -1.11626161442656, 0.944211923845315, 0.447611333729661, -1.40483814179052,
							-1.25132481610885, -1.17338168270885, -1.09934085873694, 0.860947224470899, 0.44500258004792, -1.4319367945201,
							-1.17902146750859, -0.989188484010674, -1.05897267550915, 0.545302623597864, 0.44713083405475, -1.41803954491677,
							-1.12399778847789, -0.82467946666939, -1.0168988082714, 0.169398563857863, 0.447570553242328, -1.39151640979179,
							-1.10872774202091, -0.765248041108891, -1.00003516985354, -0.00350208282716612, 0.445712322358689, -1.41332892533034,
							-1.08903670910933, -0.681107816641211, -0.974161229896609, -0.282624680996626, 0.445992716317222, -1.40425040738577,
							-1.07104210216368, -0.596951162364984, -0.946166934959542, -0.589076650740476, 0.44698840752362, -1.40725187448486,
							-0.956364966409965, -0.311104234963203, -0.829811013571882, -1.58077277798668, 0.446589927309415, -1.4089348552386,
							-0.537431143818747, 0.00458270070440708, -0.637653928244931, -1.709742031279, 0.447587594511432, -1.3957526456718,
							-0.175222605288466, 0.151996148859316, -0.499154189499144, -1.16393563254013, 0.446559510584121, -1.40689696471428,
							0.109878076404018, 0.254690725537047, -0.371987623860716, -0.665806785889356, 0.446670328237986, -1.41133637842838,
							0.334700751581652, 0.337255736967686, -0.24676773833486, -0.274722837083815, 0.446754492077754, -1.41457852175822,
							0.474336626844417, 0.396792468614104, -0.14329668524372, -0.0723350961937406, 0.446889629824007, -1.41825579378057,
							0.592108056751221, 0.455374565071898, -0.0294876660150817, 0.0601289118024228, 0.447783555485869, -1.40282117835721,
							0.663588668289566, 0.496070286746487, 0.0573171082373225, 0.129685422217688, 0.446277086118054, -1.40556801889354,
							0.706510271983259, 0.522824781566677, 0.119127016629868, 0.158485134414585, 0.445358211792053, -1.41931877695612,
							0.753944493761065, 0.555972045675174, 0.200127224713247, 0.176506844740941, 0.446164885267347, -1.43142492395999,
							0.806373716873296, 0.596991044322353, 0.309199358620625, 0.183576170924983, 0.447868081867284, -1.39879945922466,
							0.824720001927042, 0.613271293453205, 0.356020749590219, 0.174557977187264, 0.445948912213816, -1.40808900447635,
							0.851346857094763, 0.636938590028497, 0.427291061468478, 0.174766175974977, 0.447098991804316, -1.41835520427426,
							0.869479398410524, 0.653155503788234, 0.478808332051603, 0.175714585725722, 0.446968836636663, -1.4137605727216,
							0.887634713945055, 0.672533725706965, 0.543163679745733, 0.162883029074125, 0.448680797757389, -1.40740970586518,
							0.900809233900095, 0.685786914379727, 0.58976629575269, 0.160053880312554, 0.44807439838013, -1.41780060717237,
							0.909640796415693, 0.695481982281507, 0.624295218206278, 0.156621781983382, 0.449439897404624, -1.41230518491793,
							0.901556887308771, 0.686897178792749, 0.593230123112462, 0.158335646811833, 0.451280957555959, -1.42211706728299,
							-1.9016061739116, -2.87647242865828, -1.30079920914735, 2.1158780564508, 1.33932702092774, -1.41159535794489,
							-1.65656375047607, -2.08437084133691, -1.23122813341249, 1.51752991262585, 1.33946848186393, -1.41202439391795,
							-1.42281763332717, -1.54371490631959, -1.1633759490736, 1.19956124302576, 1.33925133684059, -1.4128562925788,
							-1.26615603784282, -1.20126318098808, -1.1047021079945, 0.877545777151689, 1.33964061163481, -1.41194591405405,
							-1.16879868724608, -0.962108870385431, -1.05256600284484, 0.491929767045927, 1.33973653606302, -1.41272375539901,
							-1.11297032476872, -0.781730317298658, -1.00478616988915, 0.0403714604646276, 1.33969293126292, -1.41186917537142,
							-1.08092633632073, -0.639917744281587, -0.960687749349681, -0.438222281249462, 1.33984514094004, -1.41239151920923,
							-1.05155673447948, -0.522318584248169, -0.919407401083841, -0.863016696449182, 1.33957737973452, -1.41187353929607,
							-1.01954004283768, -0.425978964408721, -0.881153905505893, -1.22439076780236, 1.33965422216461, -1.41186045636964,
							-0.98126070298896, -0.346071187173589, -0.846131422894978, -1.49431823523731, 1.33942844407887, -1.41196946211832,
							-0.933240757786285, -0.280510391441701, -0.815044661156446, -1.65524554199027, 1.33963896269901, -1.41204968741055,
							-0.880389148065321, -0.221997661157823, -0.784830298024119, -1.76776913274226, 1.33982864136676, -1.41199910785709,
							-0.572553895545876, -0.0114559702508057, -0.650479806290868, -1.75169691474578, 1.33930291035926, -1.41226158566203,
							-0.026135517785801, 0.206005720004427, -0.435929011340037, -0.907743679433709, 1.33949071182925, -1.41222931859578,
							0.312872013050983, 0.329326446311422, -0.259983346090149, -0.317180022399312, 1.33961414690346, -1.41173400518559,
							0.513980173505985, 0.415975189316006, -0.108178214010065, -0.023577366443694, 1.33973189928408, -1.41189795335077,
							0.640522378806556, 0.482466750019478, 0.0270809246081855, 0.109512343413074, 1.33990083339106, -1.41222670186893,
							0.726428975066444, 0.536665570821799, 0.151957960621413, 0.162354606959271, 1.33971537926873, -1.4119406859087,
							0.786384816293016, 0.581622637983383, 0.266678219713324, 0.174540333435976, 1.33958621039621, -1.41216392130444,
							0.832533153704759, 0.619132641737509, 0.373148416161209, 0.181415060225459, 1.33972472437163, -1.41327922521503,
							0.868008337571769, 0.653359049076561, 0.478927904833043, 0.164292449648457, 1.33967094318731, -1.41109744196376,
							0.896466887192414, 0.681489942677327, 0.573986476048149, 0.160732211052029, 1.33953890230532, -1.41197818182814,
							0.919784158539083, 0.706825061703982, 0.66661883903111, 0.152147629819745, 1.3394682127196, -1.41188487360941,
							0.940390370944224, 0.72915071020859, 0.754980876165443, 0.155505298311949, 1.33968197810748, -1.41172092862928,
							0.957049431936907, 0.749055179335732, 0.838360166066941, 0.157611557734424, 1.33976439761897, -1.41220577230086,
							0.97126117870626, 0.766909187133834, 0.919005903823261, 0.160256890949238, 1.33969235549817, -1.41240982744974,
							0.984938670559698, 0.782981216350202, 0.99616329465677, 0.175434816985672, 1.34029673458848, -1.41211769753588,
							0.995154703908877, 0.797510912291869, 1.06922554651731, 0.188067494289629, 1.34097777895167, -1.41080619644288,
							1.0036868595138, 0.807445053806468, 1.12275676456381, 0.20565993981836, 1.343867067978, -1.415800209736,
							1.01492714574288, 0.822548613809591, 1.20671056296122, 0.225221509849227, 1.35399501619608, -1.39060777315613,
							-1.32483363480108, -1.33323735920369, -1.12931641302314, 1.03146443645633, 1.33974942092545, 0.070054604416162,
							-1.11063682578734, -0.775002480558331, -1.00291229835819, 0.0295929669123823, 1.33952550640884, 0.0742228216773793,
							-1.02979710985646, -0.452189697666155, -0.891843262101017, -1.13038349593241, 1.33966680381378, 0.0805850224929995,
							-0.911202508083509, -0.25405915184, -0.801789451692011, -1.70933796205006, 1.33975941333724, 0.0752544037770415,
							-0.755406913971063, -0.120277850105881, -0.725806245214913, -1.84614836831641, 1.33956891020248, 0.0723793960014824,
							-0.594369850228347, -0.0244408050382772, -0.660056376415039, -1.76323405783882, 1.33967481682189, 0.0717907676484062,
							-0.443666888306901, 0.0471605480036845, -0.602119966358654, -1.59022266639668, 1.33967522224196, 0.0706109430537282,
							-0.297450906589817, 0.106683510900977, -0.546743990068862, -1.37284844340974, 1.33954877547539, 0.074709382819464,
							-0.164130051919687, 0.156611024261228, -0.494141946732044, -1.14763237726228, 1.33962667063624, 0.072712493934644,
							-0.0493166237833585, 0.197718499906546, -0.445921149869623, -0.948365188111726, 1.33965656269884, 0.0720855142893137,
							0.0508840568551384, 0.232359969310509, -0.401752726282499, -0.763694032358358, 1.33983588100993, 0.0716189717016343,
							0.141411464097884, 0.264527781864616, -0.357731158284595, -0.603739348718368, 1.33978041000744, 0.0722989676429749,
							0.443384095829276, 0.383117819145975, -0.168288549331711, -0.114466605789942, 1.3396373887154, 0.0772443406758819,
							0.71211718605708, 0.526643561022501, 0.12789790164176, 0.160761949107085, 1.33926054566685, 0.0749308880046683,
							0.83152684493731, 0.617772976994051, 0.369519641665867, 0.184007502364715, 1.33965746893236, 0.0700083852485626,
							0.898474635052343, 0.682899251615357, 0.579217914474934, 0.168730600195619, 1.33976825986389, 0.0702159312540594,
							0.943185636134199, 0.731862807791006, 0.766163636001105, 0.159558739271846, 1.33922345824972, 0.0655829261134059,
							0.976520597624114, 0.772437309784637, 0.945170154496968, 0.172287465556014, 1.33979325058034, 0.0732627483456338,
							1.00110349576283, 0.804486058118679, 1.10660271930286, 0.192849916044708, 1.3396347074918, 0.0703816082139224,
							1.02258861195729, 0.832132136660698, 1.26354477115033, 0.248652414074705, 1.33987434821853, 0.0717872810387264,
							1.04104407978093, 0.855336501335142, 1.4114660497607, 0.328147159517615, 1.33945202657929, 0.0701784264870947,
							1.0554968775213, 0.87569435618879, 1.55421658781871, 0.395901792535939, 1.33966448372162, 0.0751061626969912,
							1.07021615209269, 0.893508964860688, 1.69350944292367, 0.503985317558254, 1.33948512452727, 0.0758203472244827,
							1.0822475993873, 0.908928777626333, 1.82545398815087, 0.618591095784719, 1.33962945747291, 0.0728624818584271,
							1.09388795422531, 0.923004507514229, 1.956096267404, 0.74257334477239, 1.33962930075598, 0.0707469831227184,
							1.1041460390659, 0.936092049622266, 2.08828416243725, 0.872446918975994, 1.33982769425087, 0.0745506804942964,
							1.11411651687515, 0.947357113064091, 2.2132758653623, 1.01702273653839, 1.3395258543939, 0.0723915941811286,
							1.12213449412347, 0.958047606498279, 2.33877091511294, 1.15189200022169, 1.33968068689596, 0.0758517337908773,
							1.13048620421871, 0.967098784103063, 2.4565765427275, 1.30093336110783, 1.34015281387724, 0.0725162882585863,
							1.13708281354225, 0.974828959468252, 2.5627317343001, 1.4350910046358, 1.34141860682337, 0.0798952513121724,
							-1.16356877564562, -0.946228684280985, -1.04871164417897, 0.459875121261535, 1.34048265545444, 1.09365144295402,
							-1.04229056830537, -0.488945450374893, -0.906371006390758, -0.995300703862451, 1.33860490631935, 1.32782241628717,
							-0.947036686996085, -0.296543286492379, -0.82300013715664, -1.62015949955257, 1.33930694071167, 1.00305714300859,
							-0.729571207888752, -0.0989148105395008, -0.712148197242174, -1.86915047948983, 1.33916890370046, 1.31811975657504,
							-0.608829979504594, -0.0294358815534331, -0.664152089724197, -1.79159642598523, 1.33925679808653, 1.02649511377821,
							-0.395522631490299, 0.0699016248449593, -0.582345774027, -1.53830257831813, 1.33805716696743, 1.22038886038052,
							-0.240629114277803, 0.130143779138296, -0.523020566734498, -1.29278426059963, 1.33874825825253, 1.23304611186005,
							-0.0881408239266112, 0.185910869335863, -0.461060932919006, -1.03031686100946, 1.34364815477803, 1.05500820964928,
							0.0189652533899729, 0.223641246127639, -0.413987028434757, -0.838670986025272, 1.33942324516294, 1.00567494288421,
							0.0944426843412648, 0.248624960339522, -0.38013372453759, -0.695250573726054, 1.34037864988024, 1.00736402202011,
							0.253615328835634, 0.307602751418263, -0.294385419662334, -0.427891907694009, 1.33962097204287, 1.32920526359044,
							0.266649398176857, 0.312095146531531, -0.287450130531989, -0.398680946819421, 1.33958142712093, 1.00000249909346,
							0.574253538725811, 0.44809542741348, -0.0455078220634167, 0.0247204171656938, 1.34020178453079, 1.34593689511634,
							0.755140846047018, 0.558145708434817, 0.205356525441161, 0.160227535985802, 1.33760392097691, 1.01003847965936,
							0.878254518280661, 0.663632970906762, 0.513159033110476, 0.150105806320963, 1.33903029092628, 1.30960713147018,
							0.93800229849522, 0.728310416697287, 0.750637864516644, 0.134342509493675, 1.34359119837098, 1.23035860810016,
							0.962714997016989, 0.757119053456771, 0.87421297670944, 0.139906600669187, 1.3386748874432, 1.06024020246501,
							0.996778235238017, 0.800673839766868, 1.08669853109222, 0.159509139267702, 1.33520758185022, 1.25722616852921,
							1.02041077054794, 0.830903805410854, 1.2563897312163, 0.218715492966373, 1.33678887336297, 1.23828083677371,
							1.0355087179958, 0.849909509946154, 1.37540165833684, 0.278169025196821, 1.33404407355088, 1.12875337527004,
							-1.05846794035585, 1.18164385549873, 1.23450798685321, -1.94265499894155, 1.33808908613039, 1.08037067862043,
							1.07488802861426, 0.900286847370372, 1.74948357885172, 0.525853941537451, 1.34035445754615, 1.24945392494803,
							1.07904667348509, 0.905349289462986, 1.79437640612219, 0.562200820140707, 1.33041900890143, 1.13408578580024,
							1.10057724749245, 0.93225724192994, 2.04871990732305, 0.797539223861906, 1.33870192793932, 1.34046417475465,
							1.10512575883568, 0.938044871517514, 2.10853340730484, 0.861709149349617, 1.33998089192713, 1.01721950010236,
							1.1211851173676, 0.956687286890111, 2.32250498947553, 1.10626095254975, 1.34084150671083, 1.35431085422378,
							1.12223198572508, 0.958096730085123, 2.3416538027388, 1.12603623936747, 1.33743354234864, 1.19764939218011,
							1.13222365355017, 0.96909437369159, 2.48479934630084, 1.30586965504645, 1.33848444904005, 1.29032689265187,
							1.13708636982173, 0.975362160630372, 2.56933937631159, 1.41714510369056, 1.33688135001696, 1.29163495031077,
							1.13355350834022, 0.970959188220059, 2.50926002058257, 1.3406308345723, 1.3333944139166, 1.19967858776782,
							-2.0736037139679, -3.96609521355747, -1.36641693986775, 3.18390288898966, -1.33712230268041, -0.606163803364509,
							-1.9372124146363, -3.03874253471801, -1.31242531040003, 2.28696123156801, -1.33584689278542, -0.661378591620678,
							-1.79796576015764, -2.49205545599801, -1.27004333397394, 1.79116336996537, -1.33920968702695, -0.767551471182354,
							-1.58827323421124, -1.91885790822543, -1.21289875120921, 1.43896079080723, -1.34183959750351, -0.651347994540117,
							-1.50609813075025, -1.72632766607566, -1.18889290476558, 1.31955500406997, -1.33768171676922, -0.68140799499857,
							-1.40964084691813, -1.51848815955365, -1.15954227812053, 1.19423442232954, -1.33654174542506, -0.741330939467,
							-1.28756772669557, -1.25482852739006, -1.11499515429258, 0.961846638999654, -1.34123826626425, -0.563373240149191,
							-1.26858535065016, -1.21094391192039, -1.10660331728531, 0.904941565258315, -1.34333773957752, -0.752364505209028,
							-1.17385489383187, -0.981343057691011, -1.05708098161166, 0.546743549573709, -1.3409049079409, -0.560607269723197,
							-1.18824582230781, -1.01387557677596, -1.0646187065873, 0.595383135340622, -1.34234904271921, -0.773106187745623,
							-1.10850665006709, -0.765756868505694, -0.999997935007042, -0.000204954190680392, -1.34183180168466, -0.546480650733874,
							-1.13111085033116, -0.852247004472966, -1.02429401478991, 0.250344724582136, -1.33717427650886, -0.772002225579914,
							-1.03365082964761, -0.458909817603284, -0.894375129901336, -1.10889532487213, -1.34079528609742, -0.694370612510291,
							-0.740370628083278, -0.107496529108025, -0.717412493254533, -1.85978068739692, -1.34023521067587, -0.578189650594938,
							-0.487488555010421, 0.0300722420890216, -0.616636329244848, -1.6638873431681, -1.33803952211007, -0.751412274980174,
							-0.0927057759449712, 0.182011886211144, -0.464487763698071, -1.0254350781769, -1.33896727309131, -0.654540425368348,
							0.148713721724092, 0.269363157589053, -0.350910192976614, -0.608064500598405, -1.33911601710906, -0.585536356491672,
							0.322384370086029, 0.333060132210391, -0.253182759830491, -0.305130723139363, -1.34134281570234, -0.573014265288769,
							0.445873097298227, 0.384926471894481, -0.164668069113639, -0.122898040003578, -1.34457300166855, -0.570106964966279,
							0.542887057679086, 0.429274589643838, -0.0814060381805897, 0.0126713579604645, -1.34063052162984, -0.611887689159771,
							0.60297660231694, 0.46129210498461, -0.0173923962348654, 0.077929673597058, -1.33950386441601, -0.664729020493764,
							0.643575258411814, 0.484594189581909, 0.0324972887130565, 0.10464534448699, -1.33903790987005, -0.672961118690982,
							0.719357637017071, 0.531146091843395, 0.139336373020756, 0.161553261817977, -1.3398737349349, -0.602778640730025,
							0.729605932102994, 0.538915605847091, 0.157905888802481, 0.163211931568289, -1.33782997871157, -0.704966280702976,
							0.781696258554965, 0.577450908175153, 0.256421340067382, 0.176178463614938, -1.34026384559641, -0.649821970683141,
							0.799040782219174, 0.590526664693608, 0.292140863443521, 0.183155766801679, -1.34126022754948, -0.636964152079933,
							0.816398024269776, 0.605077006852436, 0.33284962500594, 0.184408678740541, -1.33587068069794, -0.702864734068814,
							0.834811920334201, 0.621117984207896, 0.380159757409689, 0.179121033124018, -1.3386844082851, -0.710582039126217,
							0.85051410224205, 0.635295988067697, 0.42296684717761, 0.176772689170365, -1.33826148532962, -0.663904968120636,
							0.850853178385659, 0.636179716556741, 0.425117841816537, 0.173400162031907, -1.33961427239061, -0.715516759172719,
							-1.98435461737075, -3.28298166037493, -1.32863499021606, 2.54173400085814, -1.3409269279773, -0.0308250118722626,
							-1.73625466014367, -2.29803088814241, -1.25242348466793, 1.64313756990105, -1.33666957538938, -0.0298161090157783,
							-1.5076586402373, -1.72583583900049, -1.18875728025338, 1.30457861981208, -1.34107654415911, 0.0276721838071645,
							-1.340043481341, -1.36419600979864, -1.1345352897882, 1.05493542594954, -1.33989391513014, 0.0579737434732348,
							-1.21266386635255, -1.07634918121026, -1.07889333179011, 0.707540740887425, -1.3436424331878, 0.219413736627045,
							-1.1809850662666, -0.992530987691611, -1.05967176017472, 0.550180586169215, -1.33908075433993, 0.0859992578589054,
							-1.13015581321663, -0.842812447224968, -1.02178510077465, 0.215065765636568, -1.337431157808, 0.0631421463585087,
							-1.09190596039921, -0.687964582616308, -0.976060284310598, -0.269233824847374, -1.34174957806925, 0.145216809758227,
							-1.06899775095183, -0.585585592353361, -0.942004265597549, -0.635165198606507, -1.33890475663779, 0.0901361632800498,
							-1.05824962283861, -0.543940596735076, -0.927040407976952, -0.788945754842591, -1.34094460686913, 0.0891472960224903,
							-1.0312488304528, -0.452298237156908, -0.891771780433702, -1.13598679826229, -1.33739933063036, 0.077473669853227,
							-0.998934821053813, -0.382685543899695, -0.86231137935869, -1.37068349907818, -1.33969942848783, 0.0576031351110191,
							-0.794984488175604, -0.146932620973457, -0.742168961056856, -1.85345780709657, -1.34147304326641, 0.0720235890978919,
							-0.346377928091689, 0.0870910252131352, -0.565668698815971, -1.44573351413497, -1.34087184621225, 0.00613085516631649,
							0.0566758278208006, 0.233638978205995, -0.399833898833347, -0.746632522810223, -1.33911211877413, 0.079588293751368,
							0.299872860044939, 0.32375436907604, -0.268522492343149, -0.33009024157935, -1.33775946032254, 0.0687712784127711,
							0.448614863259713, 0.385178211560818, -0.164455374231714, -0.106384069322211, -1.33696455269155, 0.0448807852200643,
							0.580927606915112, 0.448894509251706, -0.0427259814443165, 0.0544868836282107, -1.34109240408938, 0.0926152957429081,
							0.649795778907649, 0.486938740005113, 0.0374555728137003, 0.124442931788723, -1.34332094190047, 0.0938692479557754,
							0.729763046929575, 0.539358328382084, 0.158610340281161, 0.16333162048456, -1.33958861764829, 0.107187498653258,
							0.773232377538974, 0.571272184390391, 0.239496708495443, 0.174675100585179, -1.3404705152816, 0.104589747846007,
							0.80714199449795, 0.596435522367235, 0.308672601009661, 0.186043833818341, -1.33798517708472, 0.0785985722038389,
							0.842975233210196, 0.627501739445429, 0.399263361281043, 0.183401032541419, -1.34011601547727, 0.083840229285063,
							0.867118150331198, 0.651638700312434, 0.474225901088096, 0.169039382963205, -1.34114783676421, 0.0858886019342312,
							0.88757824151059, 0.671088515987609, 0.539248267090808, 0.166102088334453, -1.33961804892957, 0.061318766919193,
							0.904905606644441, 0.689507347243274, 0.603427535036727, 0.160741385112233, -1.34069474919429, 0.101373792664644,
							0.925097785134758, 0.712117450883025, 0.68753737739873, 0.152874083091109, -1.34212379184944, 0.0813820391304829,
							0.932578089348276, 0.71966971880311, 0.717566335579846, 0.159699228968238, -1.33963598791563, 0.0414011325093493,
							0.940626995735729, 0.729806540750435, 0.758092977309195, 0.154817070558969, -1.33844168346985, -0.00625521083159624,
							0.948042799720707, 0.73889597091323, 0.795562234513523, 0.151282188821303, -1.34002402856332, 0.065194873377139,
							-1.91611949939835, -2.94014193670766, -1.30543390809442, 2.18164748830441, -1.33970266673786, 0.881144579198299,
							-1.53958196844023, -1.79938876255719, -1.19837881500572, 1.35488317025386, -1.33595382247051, 1.20129004135131,
							-1.31836314621905, -1.31672029792585, -1.12624784396527, 1.01024057774264, -1.34429891982735, 1.40386989136065,
							-1.23664879701841, -1.13365641423983, -1.09104970541105, 0.789025892443174, -1.33969752467231, 1.24448529652481,
							-1.13809116469653, -0.871205519093226, -1.0295603310032, 0.291635737343816, -1.34214917148539, 0.896530375360405,
							-1.06649688459887, -0.577399948084001, -0.939196043039694, -0.659476846025781, -1.33936639465299, 1.32866322501964,
							-1.06715009421102, -0.578159248128848, -0.939348719944361, -0.664807557932569, -1.34160152565045, 1.33578317670571,
							-1.04321087817772, -0.491695089454352, -0.90738837050168, -0.984035472710331, -1.33819358939489, 0.868789047579035,
							-0.934120348926348, -0.281985842348599, -0.81569514004879, -1.64801380330545, -1.33995290885797, 1.30693267099989,
							-0.940858531237908, -0.289279243350993, -0.819193569558443, -1.6370866782972, -1.34027469910001, 1.41545199298222,
							-0.950046949365019, -0.299827755770423, -0.824366651998342, -1.61666703443332, -1.34097758759763, 0.905114451193276,
							-0.759406887453022, -0.12234895450427, -0.726986595770918, -1.84966835911104, -1.33881393317788, 1.2004607576474,
							-0.481541952100587, 0.0304347069236638, -0.616163679889142, -1.64363486567305, -1.3455812293823, 1.4093958267595,
							-0.103259536352852, 0.177545654394736, -0.469572977660238, -1.03981566502401, -1.34094979162413, 1.08327970596824,
							0.336631178877532, 0.337724909280483, -0.245896449325153, -0.267517136431237, -1.33702256338513, 0.976714536066045,
							0.556854245592237, 0.436426474592261, -0.0678616595004885, 0.0292939228260034, -1.34089284105017, 1.41286916267173,
							0.591741159992569, 0.455302669242688, -0.0300818469646372, 0.0651996107195739, -1.34141043397519, 1.2256662994494,
							0.699727754801155, 0.518234177433554, 0.108046037603781, 0.159231569032392, -1.33903681710983, 0.873366225910421,
							0.802854936400199, 0.594315182361401, 0.302352008524968, 0.179972565456612, -1.33992353379039, 1.40218868859397,
							0.794618451373127, 0.587131472011474, 0.282745241901905, 0.181162855109287, -1.34353532052876, 1.14605939279301,
							0.868082204079627, 0.651206397078536, 0.472137779735449, 0.188428096774601, -1.33871449028244, 1.03006512760335,
							0.890813727892253, 0.674637238823757, 0.551341482302861, 0.164528205974729, -1.34079853332066, 1.45707226163668,
							0.88682201178127, 0.670148599455444, 0.53554258412451, 0.173456132130333, -1.33906576573966, 0.866652845584326,
							0.943724665251192, 0.733832528776877, 0.774029588555041, 0.154886831217887, -1.3371995633072, 1.23458176883956,
							0.937850370521366, 0.72604558695498, 0.742815527679392, 0.15639820371618, -1.34302135436834, 1.3734898751878,
							0.959177462970774, 0.752965070414668, 0.855039512207927, 0.160442203335001, -1.33843255981549, 0.868514382565158,
							0.97736106828392, 0.774307112300301, 0.954233361875281, 0.169001007912395, -1.34115702137292, 1.46804462965996,
							0.96382614144715, 0.757732178169028, 0.877193890701389, 0.157932887627771, -1.33866084963214, 0.716240111884065,
							0.997469677638644, 0.800218442432052, 1.08436290571767, 0.189999552311397, -1.34163216211953, 1.49083477912588,
							0.97278807048978, 0.769165359799499, 0.929454245769487, 0.166775446012178, -1.33659574124359, 0.665655552808933
};
double alpha[] =
{
	0.00120202247544741, 0.00106251725956436, 0.000495473610910859, 0.000485995890041742, 0.000590776125501223, 0.000904107879029228,
	0.000647830860014916, 	0.000688864250884116, 	0.00109403120609205, 	0.00036067737130342, 	-0.000713896731695446, 	0.000325973103579851,
	-0.0010809846336559, 	0.000788122738623211, 	0.000105895874175826, 	0.000819631368977801, 	-0.000849336349728956, 	-0.00134751402989856,
	-0.00602623016214091, 	0.000572190024414182, 	-0.00663512346951858, 	-0.00371991121488602, 	-0.0067553452633804, 	0.000267343577586592,
	-0.00527614854022629, 	-0.00103339923388457, 	-0.0141674982095267, 	-0.00299956134425517, 	-0.0236845925588391, 	0.0472495897338092,
	-0.000478042877419709, 	-0.000528116491213782, 	0.000032083313564513, 	2.90036608262335E-05, 	-0.000115820685247207, 	-4.97845094416926E-05,
	-0.000225802424132824, 	-0.000349656027935523, 	-0.000217428017500315, 	-0.000206618418875216, 	-0.000268218921861848, 	0.000125863313927082,
	0.0003421914042957, 	-0.0014461360329656, 	-0.00109378314049958, 	-0.00101850154008161, 	-0.00286350430376233, 	-0.000151629923970944,
	-0.000130512870004278, 	0.000986130677215012, 	-0.00507740929835428, 	-0.00313024201348627, 	-0.0038738752405436, 	-0.00250488797019776,
	-0.00369567545844293, 	-0.0048275839819721, 	-0.00395477947459656, 	0.000585408186138074, 	0.00879110984173247, 	0.0129383606839773,
	0.000562805282717355, 	0.000194991208358742, 	3.41612514213951E-05, 	0.00135069028613594, 	0.000965442898009723, 	-0.000519969001305019,
	0.0022831127331237, 	-0.00149886455254542, 	-0.00225719404944972, 	0.00195289739146488, 	-0.000509805298299086, 	-0.00142134442317807,
	0.00162459143023977, 	0.00436128915862439, 	-0.00500411690720631, 	-0.00786479260786463, 	0.00952787691533251, 	-0.00708320661789879,
	-0.0146243037807664, 	0.00919926992172847, 	0.00191916411074289, 	-0.0210475310119785, 	-0.00441757498732115, 	0.0162661250823037,
	-0.0270227851896926, 	0.00623430546280066, 	-0.00537679378147012, 	-0.0263181771003983, 	0.0380820391740633, 	-0.00293618194946503,
	0.000333929241280103, 	1.89322812105982E-07, 	0.000369493066009645, 	0.000376445369636311, 	0.000504187141100612, 	-0.000366201962603042,
	-0.000641394548094455, 	-0.000743968121634052, 	0.000417232604252831, 	0.000693428347424003, 	0.00055309307463134, 	-0.000401060740740333,
	0.00121800543499284, 	-0.000893629100555938, 	0.00064560802792865, 	0.00576664421837953, 	0.00576291758739016, 	-0.00644011691591435,
	-0.00779717398296245, 	-0.00767723537659272, 	0.00298931323527944, 	0.0180247891596083, 	0.00932572936802793, 	-0.0210566995278436,
	-0.0401718455122527, 	-0.0351593646335689, 	-0.00619680130614601, 	0.0393620571596615, 	0.0457307749284818, 	0.0164186394629791,
	0.000574778251971161, 	-0.000128593083136281, 	0.000170996469499992, 	0.000276616721500476, 	0.000344482452930553, 	0.000544998422056509,
	0.000532456545709708, 	8.55391186339241E-05, 	-0.000365800485769471, 	-0.000541005183955349, 	-0.000166282989908109, 	-0.000376096147806832,
	0.00037936403912585, 	0.00211205421817321, 	0.00110058504315811, 	-0.000349935302593131, 	-0.000596743783287793, 	-0.000500925708953175,
	-0.000828858315609711, 	-8.51781170269641E-05, 	-0.00097965200762716, 	-0.000594842422783833, 	-0.000994925741927969, 	-0.00142117187039267,
	-0.00233795476038019, 	-0.00961907303678664, 	0.00888803695556569, 	-0.0175211138554271, 	-0.0126284039327307, 	0.0658028190661908,
	-0.00059417957341286, 	0.000376192942181011, 	0.000109099191336322, 	7.72104845140026E-05, 	-0.000141741160730253, 	-0.000297475093512176,
	0.000201485829740608, 	0.00015526222453775, 	-6.63774607186667E-05, 	0.00024125598036175, 	0.000385822072348117, 	0.000647057082792192,
	0.000894350340794344, 	-0.000282028164663983, 	0.00106212304879854, 	0.00163045163055607, 	0.000516999950611177, 	0.00133519445221905,
	-0.00226699602419629, 	-0.00505704417769663, 	0.00475408692486122, 	0.0019682138373991, 	-0.0142005773262851, 	0.00577884395113709,
	-0.00866133933613937, 	-0.00132265922596722, 	-0.0265356581043307, 	-0.0765301554064035, 	0.00187825580074244, 	0.139785665418017,
	-0.000186618560453265, 	-0.000131199720893939, 	-0.000498969562296254, 	-0.000475679562924158, 	-0.000177930287340765, 	4.36351018816266E-05,
	0.000135956021304232, 	0.000197521003295336, 	0.000264320221041666, 	0.000168062903997469, 	3.57692823106696E-05, 	-0.000933535314262141,
	-0.002525724628347, 	-0.00194222204177784, 	-0.00119726835503782, 	-0.00123295602382877, 	-0.00182203452122458, 	-0.0025161315331281,
	-0.00252230246946057, 	-0.002245364816593, 	-0.00313965015696261, 	-0.00260734306874531, 	-0.00248503654055673, 	-0.00291214286367393,
	-0.00223186334405462, 	-0.0020731998257698, 	-0.0031832668242107, 	-0.00501311908083454, 	0.0114520185991002, 	0.0235274437504556,
	0.000413578423755047, 	0.00101733862683265, 	0.00115128008802245, 	0.000712152804124115, 	-0.000822802258736826, 	-0.000892433478960009,
	-0.000595111303189606, 	-0.000403531422718942, 	-0.000273428438232329, 	-0.000263653893399297, 	-0.000031708373593418, 	0.000200839433793246,
	0.000975065068975251, 	-0.00053535685305328, 	-0.00192491610383963, 	-0.0021204604130531, 	-0.00256716664192721, 	-0.00281253235043481,
	-0.00315985684308223, 	-0.00364354228834363, 	-0.00426743947343413, 	-0.00357991827806339, 	-0.00408633314773599, 	-0.00351731026068467,
	-0.00323530414734068, 	-0.0029117107943804, 	-0.00299794049965646, 	-0.00253719514807442, 	-0.00241025426688614, 	0.00374826976475012,
	0.000844411865088445, 	0.00120229061314694, 	0.00104517114613426, 	-0.000886747645207616, 	-0.000523839426602366, 	-0.000454190480101724,
	-0.000133655194314154, 	-0.000205011881117264, 	-0.000134265080454478, 	0.000702324496358438, 	-0.000196502986325345, 	0.00150849829630056,
	-0.000230938283452767, 	0.00204270080954601, 	-0.00113018148281516, 	-0.00419744363953574, 	0.00356100607180098, 	-0.000194486159215759,
	-0.00182063564637134, 	0.00338419318209114, 	0.000411685430464489, 	-0.00868270332374971, 	0.0111731043539558, 	-0.00245822521367965,
	-0.00490715055079967, 	-0.0101273445229376, 	0.000829860897780774, 	-0.0196858231029132, 	-0.00372639924870218, 	0.0408840108021218,
	-0.00157096507811217, 	-0.000362546444126166, 	-0.00049815157923169, 	-0.000541552529874883, 	0.000168625036797023, 	-0.000896532994478391,
	0.00027689290436264, 	-0.00106348637004729, 	9.70390179217237E-05, 	-0.000651072340144002, 	-0.000208617176171512, 	-0.000126806320021073,
	-0.000239142308669084, 	-0.000790908290737065, 	0.000156354132404625, 	-0.000431450715826032, 	0.000253542565837449, 	-4.34581858144359E-05,
	0.00103201851206834, 	-0.00286330960654514, 	-0.0079310720603871, 	0.00621770008444149, 	-0.00833442357885957, 	0.00396631467158794,
	-0.0196921060089577, 	0.00786131962374238, 	-0.00627884650320156, 	-0.020534508626458, 	0.00829407589999639, 	0.0567480332214361,
	-0.000362462355399882, 	0.000137762027728248, 	-7.80551639363142E-05, 	-0.000486126745602635, 	-0.000458728039379593, 	0.000113744329255776,
	-1.76194345121232E-05, 	0.000202497862504031, 	-0.000645596591408357, 	0.000749975665255335, 	0.000176569466269962, 	5.71192498963969E-05,
	-0.00175495561559709, 	-0.00162562775038142, 	-0.00126251445966557, 	-0.000995275322641576, 	-1.46177017349539E-05, 	-0.00334869178070491,
	0.00354730341963327, 	-0.00577945692828332, 	-0.00257721832466285, 	0.00134894316128192, 	-0.00498267585359005, 	-0.00354609139619441,
	-0.0061098688823194, 	0.00548734280319859, 	-0.0235879881639255, 	-0.00301178740256983, 	0.00162315270522421, 	0.0363205588003214,
	-0.000702252665516167, 	-0.000705253476095225, 	-0.00131461445135928, 	-3.70556532542457E-05, 	-0.000171449167141308, 	-0.00467742542811982,
	0.00444766977918125, 	0.00035744910093389, 	-0.00197895461583708, 	0.00138800154802756, 	0.00148312489191808, 	-0.00230071932838109,
	-0.00191463881264094, 	0.000738007423814579, 	-0.00188851444778522, 	-0.00855055987486075, 	0.00837486483912533, 	-0.00656230882111142,
	-0.0130291852483182, 	0.0151370318050883, 	-0.0188233362642862, 	-0.00418197527939219, 	0.0106238442643845, 	-0.024413201242113,
	0.0257987225983738, 	-0.0196897605339757, 	-0.00295485083603023, 	-0.00750491580543502, 	0.0305241483482405, 	0.0458877776086467,
};
double sigmaF = 2093.750571;
double sigmal = 209.710401687991;
double yOffset = 1115.056386;

double testT;

struct vars_struct 
{
	double* x;
	double* y;
	double* ey;
};

int figarofunc(int m, int n, double* p, double* dy, double** dvec, void* vars)
{
	int i;
	struct vars_struct* v = (struct vars_struct*)vars;
	double* x, * y, * ey, f, t;

	x = v->x;
	y = v->y;
	ey = v->ey;

	for (i = 0; i < m; i++) 
	{
		t = (log(x[i] / p[2])) / p[3];
		f = p[0] + p[1] * exp(-1 * pow(t,2));
		dy[i] = (y[i] - f) / ey[i];
	}

	return 0;
}

int testfigarofit(double y[25])
{
	double x[] = { 2000, 8166.67, 14333.33, 20500, 26666.67, 32833.33, 39000, 45166.67,
		51333.33, 57500, 63666.67, 69833.33, 76000, 82166.67, 88333.33, 94500, 100666.67,
		106833.33, 113000, 119166.67, 125333.33, 131500, 137666.67, 143833.33, 150000 };   
	double ey[25];
	double p[] = { -61, -7895, 46914, 0.5737 };        /* Initial conditions */
	//double p[] = { -61, -7895, 46914, 1.38 };        /* Initial conditions */
	double perror[4];		       /* Returned parameter errors */
	mp_par pars[4];			   /* Parameter constraints */
	int i;
	struct vars_struct v;
	int status;
	mp_result result;

	memset(&result, 0, sizeof(result));          /* Zero results structure */
	result.xerror = perror;
	memset(pars, 0, sizeof(pars));    /* Initialize constraint structure */

	pars[0].limited[0] = 1;
	pars[0].limited[1] = 1;
	pars[0].limits[0] = -1062;
	pars[0].limits[1] = -60;

	pars[1].limited[0] = 1;
	pars[1].limited[1] = 1;
	pars[1].limits[0] = -12290;
	pars[1].limits[1] = -270;

	pars[2].limited[0] = 1;
	pars[2].limited[1] = 1;
	pars[2].limits[0] = 4251.3;
	pars[2].limits[1] = 89577;

	pars[3].limited[0] = 1;
	pars[3].limited[1] = 1;
	//pars[3].limits[0] = 1.38;
	pars[3].limits[0] = 0;
	pars[3].limits[1] = 1.579;

	for (i = 0; i < 25; i++) ey[i] = 0.2;       /* Data errors */

	v.x = x;
	v.y = y;
	v.ey = ey;

	/* Call fitting function for 25 data points and 4 parameters */
	status = mpfit(figarofunc, 25, 4, p, pars, 0, (void*)&v, &result);

	for (i = 0; i < 4; i++)
		curveData[i] = p[i];

	return 0;
}

double expKernel(double x)
{
	double retVal;
	retVal = pow(sigmaF, 2) * exp(-1 * x / sigmal);
	return retVal;
}

double dotProduct(double v[], double u[], int n)
{
	int i;
	double result = 0;
	for (i = 0; i < n; i++)
	{
		result += v[i] * u[i];
	}
	return result;
}

double predFigaro(double value[6])
{
	double distance[360]; 
	double kerTest[360];
	double fitNew[6];
	double retVal;
	int i,j;
	for (i = 0; i < 6; i++)
	{
		fitNew[i] = (value[i] - xOffset[i] )/scaleX[i];
	}
	double distTemp[6];
	double sum = 0;
	for (j = 0; j < 360; j++)
	{
		for (i = 0; i < 6; i++)
		{
			distTemp[i] = (fitNew[i] - xTrained[j][i]);
			distTemp[i] = distTemp[i] * distTemp[i];
			sum += distTemp[i];
		}
		distance[j] = sqrt(sum);
		sum = 0;
		kerTest[j] = expKernel(distance[j]);
	}
	retVal = dotProduct(kerTest, alpha, 360);
	return retVal;
}

void testFig(void)
{
    double y[] = { -4998.233692, -10083.34302, -8347.971176, -6578.299797, -5319.40853,
		-4433.270399,-3788.367268, -3302.150996, -2923.838245, -2621.801595, -2375.451141,
		-2170.86991,-1998.439633, -1851.372581, -1723.976919, -1612.612667, -1514.644626,
		-1428.258856,-1350.599781, -1281.35906, -1218.409147, -1161.511237, -1109.511402,
		-1062.066713, -1018.395405 };
	testfigarofit(y);
    curveData[4] = 37.03;
    curveData[5] = 20.83;
    testT = predFigaro(curveData);// + yOffset;
//    if (testT < 0)
//        testT = 0;
}

int32_t BIAShowResult(uint32_t *pData, uint32_t DataCount);
void printConsole(float f);

/* Initialize AD5940 basic blocks like clock */
int32_t AD5940PlatformCfg(void)
{
  CLKCfg_Type clk_cfg;
  FIFOCfg_Type fifo_cfg;
  AGPIOCfg_Type gpio_cfg;

  /* Use hardware reset */
  AD5940_HWReset();
  /* Platform configuration */
  AD5940_Initialize();
  /* Step1. Configure clock */
  clk_cfg.ADCClkDiv = ADCCLKDIV_1;
  clk_cfg.ADCCLkSrc = ADCCLKSRC_HFOSC;
  clk_cfg.SysClkDiv = SYSCLKDIV_1;
  clk_cfg.SysClkSrc = SYSCLKSRC_HFOSC;
  clk_cfg.HfOSC32MHzMode = bFALSE;
  clk_cfg.HFOSCEn = bTRUE;
  clk_cfg.HFXTALEn = bFALSE;
  clk_cfg.LFOSCEn = bTRUE;
  AD5940_CLKCfg(&clk_cfg);
  /* Step2. Configure FIFO and Sequencer*/
  fifo_cfg.FIFOEn = bFALSE;
  fifo_cfg.FIFOMode = FIFOMODE_FIFO;
  fifo_cfg.FIFOSize = FIFOSIZE_4KB;                       /* 4kB for FIFO, The reset 2kB for sequencer */
  fifo_cfg.FIFOSrc = FIFOSRC_DFT;
  fifo_cfg.FIFOThresh = 4;//AppBIACfg.FifoThresh;        /* DFT result. One pair for RCAL, another for Rz. One DFT result have real part and imaginary part */
  AD5940_FIFOCfg(&fifo_cfg);                             /* Disable to reset FIFO. */
  fifo_cfg.FIFOEn = bTRUE;  
  AD5940_FIFOCfg(&fifo_cfg);                             /* Enable FIFO here */
  
  /* Step3. Interrupt controller */
  
  AD5940_INTCCfg(AFEINTC_1, AFEINTSRC_ALLINT, bTRUE);           /* Enable all interrupt in Interrupt Controller 1, so we can check INTC flags */
  AD5940_INTCCfg(AFEINTC_0, AFEINTSRC_DATAFIFOTHRESH, bTRUE);   /* Interrupt Controller 0 will control GP0 to generate interrupt to MCU */
  AD5940_INTCClrFlag(AFEINTSRC_ALLINT);
  /* Step4: Reconfigure GPIO */
  gpio_cfg.FuncSet = GP6_SYNC|GP5_SYNC|GP4_SYNC|GP2_TRIG|GP1_SYNC|GP0_INT;
  gpio_cfg.InputEnSet = AGPIO_Pin2;
  gpio_cfg.OutputEnSet = AGPIO_Pin0|AGPIO_Pin1|AGPIO_Pin4|AGPIO_Pin5|AGPIO_Pin6;
  gpio_cfg.OutVal = 0;
  gpio_cfg.PullEnSet = 0;

  AD5940_AGPIOCfg(&gpio_cfg);
  AD5940_SleepKeyCtrlS(SLPKEY_UNLOCK);  /* Allow AFE to enter sleep mode. */
  return 0;
}

void AD5940MAIN_Initialize(void)
{
    uint32_t x;
    for(x = 0; x < 1.5E6; x++)
    {
        asm("NOP");
        asm("NOP");
        asm("NOP");
    }
    ad5940Data.state = AD5940_STATE_INIT;
}

uint32_t testID;
uint32_t testCHIP;

void AD5940BIAStructInit(void)
{
  AppBIACfg_Type *pBIACfg;
  
  AppBIAGetCfg(&pBIACfg);
  
  pBIACfg->SeqStartAddr = 0;
  pBIACfg->MaxSeqLen = 512; /** @todo add checker in function */
  
  pBIACfg->RcalVal = 10000.0;
  pBIACfg->DftNum = DFTNUM_8192;
  pBIACfg->NumOfData = -1;      /* Never stop until you stop it manually by AppBIACtrl() function */
  pBIACfg->BiaODR = 24.0;         /* ODR(Sample Rate) 20Hz */
  pBIACfg->FifoThresh = 4;      /* 4 */
  pBIACfg->ADCSinc3Osr = ADCSINC3OSR_2;
}

uint32_t x;

void AD5940MAIN_Tasks(void)
{
    switch(ad5940Data.state)
    {
        case AD5940_STATE_INIT:
            SPI5CONbits.ON = 1;
            AD5940_MCUResourceInit(0);
            x = AD5940PlatformCfg();
            AD5940BIAStructInit();
            x =  AppBIAInit(AppBuff, APPBUFF_SIZE);    /* Initialize BIA application. Provide a buffer, which is used to store sequencer commands */
            x = AppBIACtrl(BIACTRL_START, 0);         /* Control BIA measurement to start. Second parameter has no meaning with this command. */
            ad5940Data.state = AD5940_STATE_RUN;
            break;
        case AD5940_STATE_RUN:
            /* Check if interrupt flag which will be set when interrupt occurred. */
            if(AD5940_GetMCUIntFlag())
            {
              IntCount++;
              AD5940_ClrMCUIntFlag(); /* Clear this flag */
              temp = APPBUFF_SIZE;
              AppBIAISR(AppBuff, &temp); /* Deal with it and provide a buffer to store data we got */
              testFig();
              BIAShowResult(AppBuff, temp); /* Show the results to UART */

              if(IntCount == 240)
              {
                IntCount = 0;
                //AppBIACtrl(BIACTRL_SHUTDOWN, 0);
              }
            }
            count++;
            break;
            case AD5940_STATE_ERROR:
            break;
        default:
            break;
    }
}

void printConsole(float f)
{
    char data[64];
    char count = sprintf(data,">%f\r\n",f);
    UART2_Write((uint8_t*)data, count);
    while(!U2STAbits.TRMT);
}

void printConsoleStr(char *data)
{
    count = strlen(data);
    UART2_Write((uint8_t*)data, count);
    while(!U2STAbits.TRMT);
}

/* It's your choice here how to do with the data. Here is just an example to print them to UART */
int32_t BIAShowResult(uint32_t *pData, uint32_t DataCount)
{
  float freq;
  char str[80];
	
	// condition degueu marker

  fImpPol_Type *pImp = (fImpPol_Type*)pData;
  AppBIACtrl(BIACTRL_GETFREQ, &freq);
	if (freq == 2000) // beginning of a message
	{
			sprintf(str, "# Freq:%.2f ", freq);
            printConsoleStr(str);
	}
	else if (freq == 150000)
	{
			sprintf(str, "# Freq:%.2f ", freq);
            printConsoleStr(str);
		
			/*Process data*/
			for(int i=0;i<DataCount;i++)
			{
                sprintf(str, "RzMag: %f Ohm , RzPhase: %f #\n",pImp[i].Magnitude,pImp[i].Phase*180/M_PI);
                printConsoleStr(str);
			}
			return 0;
	}
	else
	{
			sprintf(str, "# Freq:%.2f ", freq);
            printConsoleStr(str);
	}
  
  /*Process data*/
  for(int i=0;i<DataCount;i++)
  {
    sprintf(str, "RzMag: %f Ohm , RzPhase: %f , ppm: %f #\n",pImp[i].Magnitude,pImp[i].Phase*180/M_PI, testT);
    printConsoleStr(str);
  }
  return 0;
}